{
  "id" : "io.github.electronstudio.WeylusCommunityEdition",
  "runtime" : "org.freedesktop.Platform",
  "runtime-version" : "23.08",
  "sdk" : "org.freedesktop.Sdk",
  "sdk-extensions" : [
    "org.freedesktop.Sdk.Extension.rust-stable",
    "org.freedesktop.Sdk.Extension.node18"
  ],
  "modules" : [ {
    "name" : "WeylusCommunityEdition",
    "buildsystem" : "simple",
    "build-options": {
      "append-path": "/usr/lib/sdk/rust-stable/bin:/usr/lib/sdk/llvm16/bin:/usr/lib/sdk/node18/bin",
      "build-args": ["--share=network"]
    },
    "build-commands" : [
      "tar xvf x264-x264-4613ac3c15fd75cebc4b9f65b7fb95e70a3acce1.tar.bz2",
      "cd x264-4613ac3c15fd75cebc4b9f65b7fb95e70a3acce1; ./configure --prefix=/app --exec-prefix=/app --disable-opencl --disable-cli --enable-static --enable-shared; make -j8; make install",
      "tar xvf ffmpeg-6.1.1.tar.xz",
      "cd ffmpeg-6.1.1 ; ./configure --prefix=/app --disable-debug --disable-programs --enable-gpl --enable-libx264  --disable-autodetect --enable-static --enable-shared; C_INCLUDE_PATH=/app/include LIBRARY_PATH=/app/lib make -j8; make install",
      "RUSTFLAGS=\"$RUSTFLAGS -A dead_code -A unused_imports -L /app/lib\" C_INCLUDE_PATH=/app/include LIBRARY_PATH=/app/lib cargo b --features ffmpeg-system --release",
      "mkdir /app/bin",
      "mv target/release/weylus /app/bin"
    ],
    "sources" : [
      {
        "type": "archive",
        "url": "https://github.com/electronstudio/WeylusCommunityEdition/archive/refs/tags/2024.7.29.tar.gz",
        "sha512": "d98b741f8dd04a0cb9d069d22b9b34f02f042aba0cc18de82a31de157dc4b1a84b1a6488f99e2ddaef8522760cfbafa06924cf7d188d3fbe9c2f04c4a110413f"
      },
      {"type": "file",
      "url": "https://code.videolan.org/videolan/x264/-/archive/4613ac3c15fd75cebc4b9f65b7fb95e70a3acce1/x264-4613ac3c15fd75cebc4b9f65b7fb95e70a3acce1.tar.bz2",
      "dest-filename": "x264-x264-4613ac3c15fd75cebc4b9f65b7fb95e70a3acce1.tar.bz2",
      "sha512": "6d0d9e079d6c7650abb5c00ad60cf3cfe72a220b3ee7cd030d4daeefdd9feeb4d056cf2e01b2f8d2fb0a66ccc15cdde860237f8ac5eac42ede6e5444a81346f8"
      },
      {"type": "file",
        "url": "https://www.ffmpeg.org/releases/ffmpeg-6.1.1.tar.xz",
        "dest-filename": "ffmpeg-6.1.1.tar.xz",
        "sha512": "fca3f8635f29182e3ae0fe843a8a53614e4b47e22c11508df3ff7cdbafbb4b5ee0d82d9b3332871f7c1032033b1cad2f67557d7c5f7f7d85e2adadca122965d5"
      }
    ]
  } ],
  "finish-args" : [
    "--env=PATH=/app/bin",
    "--socket=x11",
    "--socket=wayland",
    "--share=ipc",
    "--device=all",
    "--share=network"
  ],
  "command" : "/app/bin/weylus"
}